# 3D Heightmap Generator - Architecture & Data Flow

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        INFRAVISION AI DASHBOARD                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    NAVIGATION TABS (5 Total)                     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  ğŸ“· Image    ğŸ¥ Video    ğŸ”· 3D HEIGHTMAP*    ğŸ“Š Analytics  â„¹ï¸ About   â”‚
â”‚  â”‚  Analysis   Analysis    (NEW FEATURE)       Quick      â”‚         â”‚  â”‚
â”‚  â”‚                                             Stats               â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  * NEW TAB ADDED IN THIS INTEGRATION                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    ACTIVE TAB CONTENT                            â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚  3D HEIGHTMAP GENERATOR (Heightmap3D.jsx)                 â”‚ â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚
â”‚  â”‚  â”‚                                                            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ ğŸ“¤ UPLOAD SECTION                                   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                     â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ ğŸ’¾ DROP FILES HERE OR CLICK TO BROWSE      â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                             â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚         Supported: JPG, PNG, GIF, BMP      â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                             â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚         [Choose File]                       â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                     â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  Status: No file selected / File uploading /       â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚          âœ… Successfully generated!               â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ ğŸ”· 3D VIEWER (Optional - only after upload)        â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                     â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                             â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚      Interactive 3D Model Viewer           â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚      (React Three Fiber + Drei)            â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                             â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  ğŸ–±ï¸  Left Click + Drag: Rotate             â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  ğŸ–±ï¸  Scroll: Zoom                          â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  ğŸ–±ï¸  Middle Click + Drag: Pan              â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                             â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                  [3D Model]                 â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                   Renders                   â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                             â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                             â”‚   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                     â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  Model Info:                                        â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Resolution: 200 Ã— 200 pixels                     â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Height Scale: 10.0 units                         â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Smoothing: Gaussian (Ïƒ=1.0)                      â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Format: STL (ASCII)                              â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                     â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  [ğŸ“¥ Download STL File]  [ğŸ”„ Generate New]         â”‚  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  âœ¨ FEATURES                                              â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ ğŸ¨ Automatic Conversion                               â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ ğŸ” Interactive Viewer                                 â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ ğŸ’¾ STL Export                                          â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ âš™ï¸ Advanced Processing                                 â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ ğŸ—ï¸ Infrastructure Ready                                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ ğŸš€ Real-time Processing                                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                                                            â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        Frontend (React 18.2.0)
                        @ http://localhost:3000
```

---

## Backend Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FLASK API SERVER                               â”‚
â”‚                  @ http://localhost:5002                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         finalwebapp_api.py (Main API Server)              â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ New Endpoint: POST /api/generate-3d-heightmap       â”‚ â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  1. Receive multipart/form-data (image)             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  2. Save to uploads/ with UUID name                 â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  3. Call image_to_stl() converter                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  4. Return STL blob with proper headers              â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  5. Cleanup temp files                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ image_to_heightmap.py (Conversion Module)           â”‚ â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  image_to_stl(input_path, output_path)              â”‚ â”‚   â”‚
â”‚  â”‚  â”‚      â†“                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Load image (PIL) â†’ Grayscale conversion            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚      â†“                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Resize to 200Ã—200 (LANCZOS)                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚      â†“                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Apply Gaussian filter (Ïƒ=1.0)                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚      â†“                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Normalize pixel values (0â†’1)                       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚      â†“                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Map to height values (Ã—10 scale)                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚      â†“                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Generate vertex grid (200Ã—200 = 40k vertices)      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚      â†“                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Create triangle faces (~80k triangles)             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚      â†“                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Optimize mesh with trimesh                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚      â†“                                               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Export as STL (ASCII format)                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â”‚  Dependencies Used:                                        â”‚   â”‚
â”‚  â”‚  â€¢ numpy - Array operations                              â”‚   â”‚
â”‚  â”‚  â€¢ PIL (Pillow) - Image I/O                              â”‚   â”‚
â”‚  â”‚  â€¢ scipy - Gaussian filtering                            â”‚   â”‚
â”‚  â”‚  â€¢ trimesh - 3D mesh generation & export                 â”‚   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  File I/O:                                                          â”‚
â”‚  â€¢ Input: uploads/temp_[uuid].png                                  â”‚
â”‚  â€¢ Output: uploads/heightmap_[uuid].stl                            â”‚
â”‚  â€¢ Return: Binary STL blob over HTTP                               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        Backend (Python 3.10+)
                        Flask + NumPy + SciPy + Trimesh
```

---

## Data Flow Diagram

```
USER INTERACTION
        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Frontend (React - Port 3000)    â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚  â”‚ Heightmap3D.jsx Component â”‚   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ (CORS Request)
    [1. User selects image file]
        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  FormData: image = <file>                â”‚
    â”‚  POST /api/generate-3d-heightmap         â”‚
    â”‚  Headers: CORS enabled                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ (Network)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Backend (Flask - Port 5002)   â”‚
    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚ â”‚  Flask Route Handler     â”‚  â”‚
    â”‚ â”‚  @app.route(.../api/...) â”‚  â”‚
    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ (File Processing)
    [2. Save uploaded file]
        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ image_to_stl() Module         â”‚
    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚ â”‚ 2D Image Processing      â”‚  â”‚
    â”‚ â”‚ Grayscale & Normalize    â”‚  â”‚
    â”‚ â”‚ Height Mapping           â”‚  â”‚
    â”‚ â”‚ Mesh Generation          â”‚  â”‚
    â”‚ â”‚ STL Export               â”‚  â”‚
    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ (STL Generation)
    [3. Generate 3D mesh]
        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ STL File Created             â”‚
    â”‚ (Binary or ASCII format)     â”‚
    â”‚ Size: 1-5 MB                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ (HTTP Response)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Response Headers:             â”‚
    â”‚ â€¢ Content-Type: model/stl    â”‚
    â”‚ â€¢ Content-Disposition:        â”‚
    â”‚   attachment;                 â”‚
    â”‚   filename=heightmap.stl      â”‚
    â”‚ â€¢ CORS Headers                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ (Network)
    [4. Frontend receives blob]
        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Frontend Processing:             â”‚
    â”‚ â€¢ Create object URL from blob    â”‚
    â”‚ â€¢ Store modelUrl in state        â”‚
    â”‚ â€¢ Pass to STLLoader component    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ (3D Rendering)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ React Three Fiber Rendering      â”‚
    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚ â”‚ Canvas (WebGL/GPU)         â”‚   â”‚
    â”‚ â”‚ â€¢ STLLoader reads geometry  â”‚   â”‚
    â”‚ â”‚ â€¢ Creates mesh geometry     â”‚   â”‚
    â”‚ â”‚ â€¢ Applies Phong material    â”‚   â”‚
    â”‚ â”‚ â€¢ Adds lighting             â”‚   â”‚
    â”‚ â”‚ â€¢ OrbitControls attached    â”‚   â”‚
    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ (Display)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ [5. Interactive 3D Model Display] â”‚
    â”‚                                  â”‚
    â”‚     [3D Model in Canvas]         â”‚
    â”‚     Rotate/Zoom/Pan Controls     â”‚
    â”‚                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“ (User Action)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ User Options:               â”‚
    â”‚ â€¢ ğŸ“¥ Download STL File      â”‚
    â”‚ â€¢ ğŸ”„ Generate New           â”‚
    â”‚ â€¢ ğŸ–±ï¸ Interact (rotate/zoom) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Hierarchy

```
App.js (Main Entry Point)
    â†“
    [Router with 5 tabs]
    â”œâ”€â”€ ImageAnalysis (existing)
    â”œâ”€â”€ VideoAnalysis (existing)
    â”œâ”€â”€ Heightmap3D â­ NEW
    â”‚   â”œâ”€â”€ Upload Section
    â”‚   â”‚   â”œâ”€â”€ File Input
    â”‚   â”‚   â”œâ”€â”€ Drag-Drop Zone
    â”‚   â”‚   â””â”€â”€ Status Indicator
    â”‚   â”œâ”€â”€ 3D Viewer Section
    â”‚   â”‚   â”œâ”€â”€ Canvas (Three.js)
    â”‚   â”‚   â”‚   â”œâ”€â”€ Lights
    â”‚   â”‚   â”‚   â”œâ”€â”€ Mesh
    â”‚   â”‚   â”‚   â”œâ”€â”€ Camera
    â”‚   â”‚   â”‚   â””â”€â”€ OrbitControls
    â”‚   â”‚   â”œâ”€â”€ Model Info Panel
    â”‚   â”‚   â””â”€â”€ Action Buttons
    â”‚   â””â”€â”€ Features Section
    â”œâ”€â”€ Analytics (existing)
    â””â”€â”€ About (existing)
```

---

## File Organization

```
Project Root
â”œâ”€â”€ Backend
â”‚   â”œâ”€â”€ image_to_heightmap.py          â­ NEW MODULE
â”‚   â”œâ”€â”€ finalwebapp_api.py             ğŸ“ UPDATED (+endpoint)
â”‚   â”œâ”€â”€ requirements.txt               ğŸ“ UPDATED (+trimesh)
â”‚   â””â”€â”€ uploads/                       (temp files here)
â”‚
â”œâ”€â”€ Frontend
â”‚   â”œâ”€â”€ package.json                   ğŸ“ UPDATED (+3D libs)
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ App.js                     ğŸ“ UPDATED (+route)
â”‚       â”œâ”€â”€ pages/
â”‚       â”‚   â”œâ”€â”€ Heightmap3D.jsx        â­ NEW PAGE
â”‚       â”‚   â”œâ”€â”€ ImageAnalysis.jsx      (existing)
â”‚       â”‚   â”œâ”€â”€ VideoAnalysis.jsx      (existing)
â”‚       â”‚   â””â”€â”€ ...other pages
â”‚       â””â”€â”€ styles/
â”‚           â”œâ”€â”€ heightmap3d.css        â­ NEW STYLES
â”‚           â”œâ”€â”€ main.css               (existing)
â”‚           â””â”€â”€ ...other styles
â”‚
â”œâ”€â”€ Documentation
â”‚   â”œâ”€â”€ 3D_HEIGHTMAP_INTEGRATION.md    â­ NEW
â”‚   â”œâ”€â”€ 3D_HEIGHTMAP_QUICKSTART.md     â­ NEW
â”‚   â””â”€â”€ 3D_HEIGHTMAP_COMPLETE.md       â­ NEW
â”‚
â””â”€â”€ .git (version control)
```

---

## Technology Stack

```
                        FRONTEND
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  React 18   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                             â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚            â”‚            â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Three.js  â”‚  â”‚   Drei   â”‚  â”‚ Lucide   â”‚
         â”‚  (3D Core) â”‚  â”‚ (Tools)  â”‚  â”‚ (Icons)  â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚           â”‚          â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
         â”‚ @react-three/fiber                 â”‚
         â”‚ (React x Three.js Integration)     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   Canvas       â”‚
                â”‚  (WebGL/GPU)   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


                        BACKEND
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Flask 2.3.3 (Web Server)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚             â”‚
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ NumPy  â”‚   â”‚ SciPy  â”‚   â”‚ PIL    â”‚
    â”‚(Arrays)â”‚   â”‚(Signal)â”‚   â”‚(Image) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ image_to_heightmap â”‚
            â”‚ (2D â†’ 3D Converter)â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ trimesh 4.9.0      â”‚
            â”‚ (Mesh Generation)  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Request/Response Flow

```
UPLOAD REQUEST (Browser â†’ Server)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/generate-3d-heightmap HTTP/1.1            â”‚
â”‚ Host: localhost:5002                                â”‚
â”‚ Content-Type: multipart/form-data; boundary=xyz    â”‚
â”‚ Origin: http://localhost:3000                       â”‚
â”‚ Access-Control-Request-Method: POST                 â”‚
â”‚                                                     â”‚
â”‚ --xyz                                               â”‚
â”‚ Content-Disposition: form-data; name="image"       â”‚
â”‚                                                     â”‚
â”‚ [BINARY IMAGE DATA: JPG/PNG/etc]                    â”‚
â”‚ --xyz--                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ (Server processes)
DOWNLOAD RESPONSE (Server â†’ Browser)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP/1.1 200 OK                                     â”‚
â”‚ Content-Type: model/stl                             â”‚
â”‚ Content-Disposition: attachment;                    â”‚
â”‚   filename=heightmap.stl                            â”‚
â”‚ Access-Control-Allow-Origin: *                      â”‚
â”‚ Content-Length: 2458234                             â”‚
â”‚                                                     â”‚
â”‚ [BINARY STL DATA: ASCII or Binary format]           â”‚
â”‚ solid heightmap                                     â”‚
â”‚ facet normal 0.0 0.0 1.0                            â”‚
â”‚   outer loop                                        â”‚
â”‚     vertex 0.0 0.0 0.0                              â”‚
â”‚     vertex 1.0 0.0 0.0                              â”‚
â”‚     vertex 0.5 1.0 2.5                              â”‚
â”‚   endloop                                           â”‚
â”‚ endfacet                                            â”‚
â”‚ ...                                                 â”‚
â”‚ endsolid heightmap                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Sequence Diagram

```
User              Frontend             Backend         File System
â”‚                 â”‚                    â”‚                â”‚
â”œâ”€ Click Tab â”€â”€â”€â”€â†’â”‚                    â”‚                â”‚
â”‚                 â”‚                    â”‚                â”‚
â”œâ”€ Select File â”€â”€â†’â”‚                    â”‚                â”‚
â”‚                 â”‚                    â”‚                â”‚
â”œâ”€ Drop/Browse â”€â”€â†’â”‚ Validate File      â”‚                â”‚
â”‚                 â”‚ Create FormData    â”‚                â”‚
â”‚                 â”‚                    â”‚                â”‚
â”‚                 â”œâ”€ POST Request â”€â”€â”€â”€â†’â”‚                â”‚
â”‚                 â”‚ (with image)       â”‚                â”‚
â”‚                 â”‚                    â”œâ”€ Save File â”€â”€â”€â†’â”‚
â”‚                 â”‚                    â”‚                â”œâ”€ uploads/temp_xyz.png
â”‚                 â”‚                    â”‚                â”‚
â”‚                 â”‚                    â”œâ”€ Call image_to_stl()
â”‚                 â”‚                    â”‚ â€¢ Load image   â”‚
â”‚                 â”‚                    â”‚ â€¢ Grayscale    â”‚
â”‚                 â”‚                    â”‚ â€¢ Resize       â”‚
â”‚                 â”‚                    â”‚ â€¢ Smooth       â”‚
â”‚                 â”‚                    â”‚ â€¢ Map heights  â”‚
â”‚                 â”‚                    â”‚ â€¢ Gen vertices â”‚
â”‚                 â”‚                    â”‚ â€¢ Gen faces    â”‚
â”‚                 â”‚                    â”‚ â€¢ Export STL   â”‚
â”‚                 â”‚                    â”‚                â”œâ”€ uploads/heightmap_xyz.stl
â”‚                 â”‚                    â”‚                â”‚
â”‚                 â”‚ â† Response (STL) â”€â”€â”¤                â”‚
â”‚                 â”‚                    â”œâ”€ Cleanup â”€â”€â”€â”€â”€â†’â”‚ Delete temp file
â”‚                 â”‚                    â”‚                â”‚
â”‚                 â”‚ Create ObjectURL   â”‚                â”‚
â”‚                 â”‚ setState(modelUrl) â”‚                â”‚
â”‚                 â”‚                    â”‚                â”‚
â”‚                 â”œâ”€ Load in STLLoader â”‚                â”‚
â”‚                 â”‚ Render in Canvas   â”‚                â”‚
â”‚                 â”‚ Enable Controls    â”‚                â”‚
â”‚                 â”‚                    â”‚                â”‚
â”œâ”€ View Model â”€â”€â”€â†’â”‚ (Interactive View) â”‚                â”‚
â”‚ Rotate/Zoom     â”‚ OrbitControls      â”‚                â”‚
â”œâ”€ Download â”€â”€â”€â”€â”€â†’â”‚ trigger download() â”‚                â”‚
â”‚                 â”‚ Browser saves file â”‚                â”‚
â”‚                 â”‚                    â”‚                â”‚
```

---

This architecture ensures:
- âœ… Clean separation of concerns
- âœ… Scalable and maintainable code
- âœ… Proper CORS handling
- âœ… Efficient 3D rendering
- âœ… Resource cleanup
- âœ… Error handling at each layer
